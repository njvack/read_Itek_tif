# read_itek: Reads the files written by an MRI-compatible EMG amplifier

## Overview

If you aren't at the Center for Healthy Minds, this project is not very interesting for you.

### `itf2hdf5`


```
Usage: itf2hdf5 [options] <itf_file> <hdf5_file>

Converts a .itf and .itf.ita file (if available) pair into a single HDF5 file.

Options:
  -v --verbose           Show debugging output
  --card_map=<order>     Change the mapping of cards to channel blocks
                         (16 numbers separated by commas)
                         [default: 1,0,2,3,4,5,6,7,8,9,10,11,12,13,14,15]
  --all                  Capture channels, even if the corresponding card is
                         off
  --channel_names=<str>  Use a string of the format num1:name,num2:name,...
                         to name the channels.

The output file layout looks like:

/channels/channel_XXX:  The data for a channel. Signed 32-bit integer.
  scale_factor: The scale factor needed to convert this channel to mV.
  gain:         The gain, as read from the .ita file
  lpf:          The lowpass filter cutoff, as read from the .ita file
  on:           Whether the channel is on or not, as read from the .ita file

/channels/NAME:         An alias for one of the numbered channels.

/parallel_port:         Parallel port data. 1 unsigned byte / sample.

/is_missing:            True if this frame is missing (as determied by the
                        record counter and whether read frames are valid).
                        Boolean per sample.

/error_flags:           Error flags as reported by itekanalyze. (meaning?)
                        1 unsigned byte / sample.

/status_flags:          Status flags as reported by itekanalyze. (meaning?)
                        Unsigned byte / sample.

/tr_register:           I don't know what this is used for at all.
                        2 unsigned bytes / sample.

In addition, the root group has the following attributes:
  samples_per_second:   The sampling rate of the file. Always 1000 / 2.048.
  read_itek_version:    The version of read_itek that made this .hdf5 file.

If the .itf.ita file is missing, all channel attributes are set to 'unknown'
except for scale_factor, which is set to 1.0.
```

### `itek_hdf5_clip_stats`

```
Usage: itek_hdf5_clip_stats [options] <hdf5_file>...

Files are expected to be in the format generated by itf2hdf5. For each channel
in each listed file, generate an output file listing the filename, channel,
and how much of the channel was offscale in total, low, and high.

Options:
  -v --verbose             Show debugging output
  --channels=<channels>    A comma-separated list of channel names, or 'all'
                           Examples: 'channel_012,channel_013', 'zygo,corr'
                           [default: all]
```

### `itf2csv`

```
Usage: itf2csv [options] <data_file> [<output_file>]

Reads a .itf file written by ItekAnalyze, and converts it to a .csv format,
with one channel per row, followed by parallel port data. If a corresponding
.itf.ita file exists, it reads that as well and uses it to scale the data.

Made to mirror, as closely as possible, the behavor of docs/readitf.c

Options:
  -v, --verbose  Display debugging output
```

## Credits

Written by Nathan Vack <njvack@wisc.edu> and Jonah Chaiken <jchaiken@wisc.edu>

read_itek packages two wonderful tools: [docopt](https://github.com/docopt/docopt) and [schema](https://github.com/halst/schema).

docopt is copyright (c) 2013 Vladimir Keleshev <vladimir@keleshev.com>

schema is copyright (c) 2012 Vladimir Keleshev <vladimir@keleshev.com>
